<div class="backprop-demo">
  <h2>RetropropagaciÃ³ interactiva</h2>
  <p class="bp-intro">
    Aquesta demostraciÃ³ visual explica pas a pas com funciona la retropropagaciÃ³ en una xarxa neuronal.
    Fes clic a "SegÃ¼ent pas" per avanÃ§ar per cada fase de l'algorisme.
  </p>

  <div class="bp-toolbar">
  <button id="bp-play">â¯ Reprodueix</button>
  <div id="bp-stepper" class="bp-stepper" aria-label="Control de passos">
  <span class="bp-stepper-label">ProgrÃ©s</span>
    <input id="bp-step-slider" class="bp-stepper-slider" type="range" min="0" max="16" value="0" aria-label="Pas actual">
    <div class="bp-stepper-buttons">
  <!-- TODO(Fletxes ProgrÃ©s): aquests dos botons defineixen els triangles (sÃ³n carÃ cters Unicode â—€ i â–¶). Canvia el text interior o substitueix-lo per SVG/icones si vols un estil diferent. -->
  <button id="bp-step-back" class="bp-stepper-btn" aria-label="Pas anterior" title="Pas anterior" disabled>â—€</button>
  <button id="bp-step-forward" class="bp-stepper-btn" aria-label="SegÃ¼ent pas" title="SegÃ¼ent pas">â–¶</button>
    </div>
  </div>
  <button id="bp-reset">ğŸ”„ Reinicia</button>
    
    <!-- ORDRE INTERCANVIAT: primer velocitat, desprÃ©s taxa d'aprenentatge -->
    <span class="bp-inline bp-inline-speed">
      Velocitat: <code id="speed-value">1000ms</code>
      <input type="range" id="speed" min="250" max="4500" step="250" value="1000">
    </span>

    <span class="bp-inline bp-inline-lr">
      Î± (lr): <code id="bp-lr-value">0.3</code>
      <input type="range" id="bp-lr" min="0.1" max="1" step="0.1" value="0.3">
    </span>

    <span class="bp-inline bp-inline-error">
      Error: <code id="bp-loss">-</code>
    </span>
  </div>

  <div class="bp-phase-label" id="bp-phase-label">Pas 0: InicialitzaciÃ³ de la xarxa</div>

  <div class="bp-canvas-wrapper">
    <div class="bp-equation-overlay" id="bp-equation-overlay"></div>
  <div id="bp-tooltip" class="bp-tooltip" hidden></div>
        <canvas id="bp-network" width="750" height="300"></canvas>
  </div>

  <!-- Interactive Questions Section -->
  <div class="bp-questions">
    <h3>ğŸ¤” Explora i AprÃ¨n</h3>
    <details>
      <summary>ğŸ’¡ QuÃ¨ Ã©s la funciÃ³ sigmoide?</summary>
      <p>La funciÃ³ sigmoide Ïƒ(x) = 1/(1+e^(-x)) Ã©s una funciÃ³ d'activaciÃ³ que mapeja qualsevol nÃºmero real a un valor entre 0 i 1. Ã‰s especialment Ãºtil perquÃ¨ tÃ© una derivada simple: Ïƒ'(x) = Ïƒ(x)(1-Ïƒ(x)).</p>
    </details>
    
    <details>
      <summary>ğŸ“ˆ Com funciona la taxa d'aprenentatge?</summary>
      <p>La taxa d'aprenentatge (Î±) controla la magnitud dels canvis en els pesos durant l'entrenament. Una taxa alta pot fer que l'algoritme convergeixi rÃ pidament perÃ² pot saltar el mÃ­nim Ã²ptim. Una taxa baixa Ã©s mÃ©s estable perÃ² mÃ©s lenta.</p>
    </details>
    
    <details>
      <summary>ğŸ¯ Per quÃ¨ utilitzem XOR?</summary>
      <p>XOR Ã©s un problema clÃ ssic que no es pot resoldre amb una sola neurona (no Ã©s linealment separable). Demostra la necessitat de capes ocultes en les xarxes neuronals per aprendre funcions no lineals.</p>
    </details>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const canvas = document.getElementById('bp-network');
  if (canvas && !canvas.dataset.bpInit) {
    new BackpropDemo();
    canvas.dataset.bpInit = '1';
  }
});
</script>
