<div class="lang-selector">
  {% assign current_url = page.url %}
  {% if page.lang == 'ca' %}
    {% assign en_url = current_url %}
    {% if current_url == '/' %}
      {% assign en_url = '/index_en/' %}
    {% else %}
      {% assign en_url = current_url | append: '_en/' %}
    {% endif %}
    <a href="{{ en_url }}">EN</a>
  {% else %} {# page.lang == 'en' #}
    {% assign ca_url = current_url | replace: '_en/', '/' %}
    <a href="{{ ca_url }}">CA</a>
  {% endif %}
</div>